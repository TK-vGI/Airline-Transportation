# Stage 4/6: Boeing vs. Airbus Comparison
## Description
In this stage, imagine you, as a data analyst, want to compare the average flight durations between Boeing and  
Airbus aircraft to see if there's a notable difference. Before doing that, you'll gather data on flight durations  
and frequencies for both Boeing and Airbus planes across different airline companies. You aim to collect information  
on how long these planes fly on average and how often they're used for flights.

## Objectives
- Identify the `aircraft_type` (Boeing or Airbus) based on the `plane_type` recorded in the `Trip` table. For instance,  
  if the `plane_type` is **Boeing 737**, the `aircraft_type` would be **Boeing**.
- Identify the `AVG` flight duration in minutes as `avg_flight_duration` and `COUNT` the number of flights as `num_flights`  
  for each `aircraft_type` across all flights recorded in the `Trip` table.
- All **Boeing** aircraft types in the `plane_type` column start with the word "Boeing," and  
  all **Airbus** aircraft types start with the word "Airbus."
- The column order is essential.

### ChatGPT prompts that help to write the query
- Imagine you have a dataset containing various aircraft types recorded in a specific column. How would you formulate  
  an SQL query to categorize these aircraft types into distinct groups based on certain patterns or characteristics?
- Now, assuming you have a dataset with flight records including departure and arrival times, how would you write  
  an SQL query to calculate the average duration of flights for each type of aircraft?
- In addition to calculating average flight durations, how would you formulate an SQL query to count the total number  
  of flights recorded for each type of aircraft in the dataset?

Take a look at the following database structure:

![Explanation of the database](./STAGE1_IMG1.png)

### Explanation of the database
The **`Airline Transportation Database`** encompasses four main tables: `Airline_Company`, `Trip`, `Passenger`, and `Pass_in_trip`.  
It facilitates the management of airline operations, storing critical information about airline companies, flights,  
passengers, and trip details.

In-depth details of each table are as follows:

`Airline_company`**: Serves as a repository for airline company information, providing a unique identifier for      
each company along with their respective names.
- `ID_comp`: Primary key representing the unique identifier for each airline company.
- `company_name`: Stores the name of the airline company, enabling identification and association with flight operations.

`Trip`**: Contains detailed information about each flight trip.
- `trip_no`: Primary key serving as a unique identifier for each flight trip.
- `ID_comp`: Foreign key referencing the ID_comp in the Airline_Company table, establishing a relationship between flights and airline companies.
- `plane_type`: Records the type of aircraft used for the flight.
- `town_from`: Indicates the departure city of the flight.
- `town_to`: Specifies the arrival city of the flight.
- `time_out`: Stores the departure time of the flight.
- `time_in`: Records the arrival time of the flight.

`Passenger`**: Maintains records of individual passengers.
- `ID_psg`: Primary key representing the unique identifier for each passenger.
- `passenger_name`: Stores the name of the passenger, facilitating passenger identification and management.

`Pass_in_trip`**: Serves as a bridge between passengers and trip details.
- `trip_no`: Foreign key referencing the trip_no in the Trip table, establishing a relationship between passengers and flights.
- `trip_date`: Records the date of the trip, allowing for chronological organization of passenger-trip associations.
- `ID_psg`: Foreign key referencing the ID_psg in the Passenger table, associating passengers with specific trips.
- `seat_number`: Indicates the seat number occupied by the passenger during the trip, providing seating information   
  for passenger tracking and flight organization.

### Additional information and rules to consider:
- flights operate daily, and the flight duration of any flight is less than a day; `town_from` <> `town_to`.
- time and date in the `time_out` and `time_in` are taken into account relative to one-time zone.
- `time_out` and `time_in` times are indicated accurate to the minute.
- `passenger_name` may have namesakes (same name field values).
- the `seat_number` in the cabin is a number with a letter; the number determines the number of the row  
  in the range from 01 to 99, and the letter (a – d) – the place in the row from left to right in alphabetical order.

** _Table names are case-sensitive._

Click on the [Database.sql](Database.sql) to download the SQL query for creating the database.

## Example

_Trip Table Example:_

| trip_no | ID_comp | plane_type  | town_from | town_to     | time_out            | time_in             |
|---------|---------|-------------|-----------|-------------|---------------------|---------------------|
| 1       | 1       | Boeing 737  | Chicago   | Miami       | 2024-02-23 08:00:00 | 2024-02-23 18:45:00 |
| 2       | 2       | Airbus A320 | New York  | Boston      | 2024-02-24 23:00:00 | 2024-02-25 08:00:00 |
| 3       | 2       | Boeing 777  | New York  | Los Angeles | 2024-02-24 23:00:00 | 2024-02-25 08:00:00 |
| 4       | 2       | Airbus A330 | Denver    | Chicago     | 2024-02-24 16:40:00 | 2024-02-24 23:30:00 |

From the data provided, we see that both `plane_type`: **Boeing 737** and **Boeing 777** fall under the `aircraft_type`: **Boeing**,  
resulting in a total of **2** `num_flights`. The first flight duration is from ` "2024-02-23 08:00:00" `  to` "2024-02-23 18:45:00" `,  
which equals 10 hours and 45 minutes or 645 minutes. The second flight duration is from ` "2024-02-24 23:00:00" ` to ` "2024-02-25 08:00:00" `,  
totaling 9 hours or 540 minutes. The average `avg_flight_duration` for these two flights is calculated as (645 + 540) / 2 = **592.5** minutes.

The resulting output table displays each `aircraft_type` alongside its corresponding `avg_flight_duration` and `num_flights`:

| aircraft_type | avg_flight_duration | num_flights |
|---------------|---------------------|-------------|
| Boeing        | 592.5               | 2           |
| Airbus        | 560                 | 2           |

_From the output above, it can be seen that the order of the columns is `aircraft_type` -> `avg_flight_duration` -> `num_flights`_

## Query template:
```markdown
SELECT
    'Boeing' AS aircraft_type, ...;
```